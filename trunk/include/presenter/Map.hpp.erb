
<%= header_guard %>

#include <boost/tr1/memory.hpp>

namespace psc{ namespace presenter{

class Map: public std::tr1::enable_shared_from_this<Map>{
public:
    typedef std::tr1::shared_ptr<Map> pointer_type;
    typedef std::list<pCube> CubeList;

public:
    static pointer_type create(pMapSetting setting){ return ObjectPool<Map>::create(setting)->init(); }

public:
    Map(pMapSetting setting): setting_(setting) {}
public:
    Map& operator<<(model::pCube mCube){
        cubes_.push_back(Cube::create(mCube));
    }

private:
    pointer_type init(){
        model_ = model::Map::create(shared_from_this(), setting_);
        view_ = view::Map::create(shared_from_this());
        return shared_from_this();
    }

private:
    pMapSetting setting_;
    model::pMap model_;
    view::pMap view_;
    CubeList cubes_;
};

}} // end of namespace

#endif
